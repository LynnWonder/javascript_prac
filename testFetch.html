<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>fetch请求</title>
</head>
<body>
<script>
    const url='https://www.baidu.com';
    const opt={
        method:'get',
        credentials:'include',
        mode:'cors',
        heads:{
            // 允许接收的编码类型
            Accept:'application/json',
            // 发送给接收者的实体正文媒体类型
            'Content-Type': 'application/json; charset=utf-8',
        }
    };
    const checkStatus=(response)=>{
        const {status}=response;
        if (status>=200&&status<300){
            return response;
        }
        const error=new Error(response.statusText);
        error.response = response;
        throw error;
    };
    /**
     * 读取 Response对象并且将它设置为已读（因为Responses对象被设置为了 stream 的方式，所以它们只能被读取一次） ,并返回一个被解析为JSON格式的promise对象。
     *以上参考了MDN
     * @param response
     */
    const parseJSON=(response)=>{
        // 一个http响应，并不是真的json
        return response.json;
    };
    fetch(url,opt).then(checkStatus).then(parseJSON).then((data)=>{
        console.info(data);
    }).catch((err)=>{
        console.info(err);
    })
</script>
</body>
</html>